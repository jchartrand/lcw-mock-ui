/*! For license information please see index.8c6261d5ef321f6756a1.cjs.LICENSE.txt */
"use strict";var undici=require("undici"),node_process=require("node:process");const AGENT_CACHE=new WeakMap,[major,minor]=node_process.versions.node.split(".").map((e=>parseInt(e,10))),canConvert=major>18||18===major&&minor>=2;function convertAgent(e){if(!canConvert)return e;if(e?.fetch&&!e.fetch._httpClientCustomFetch)return e;const t=e?.agent||e?.httpsAgent;if(!t)return e;let n=AGENT_CACHE.get(t);if(!n){n=createFetch(new undici.Agent({connect:t.options})),n._httpClientCustomFetch=!0,AGENT_CACHE.set(t,n)}return{...e,fetch:n}}function createFetch(e){return function(...t){return e=t[1]&&t[1].dispatcher||e,t[1]={...t[1],dispatcher:e},globalThis.fetch(...t)}}function deferred(e){let t;return{then:(n,r)=>(t||(t=new Promise((t=>t(e())))),t.then(n,r))}}const kyOriginalPromise=deferred((()=>import("ky").then((({default:e})=>e)))),DEFAULT_HEADERS={Accept:"application/ld+json, application/json"},PROXY_METHODS=new Set(["get","post","put","push","patch","head","delete"]);function createInstance({parent:e=kyOriginalPromise,headers:t={},...n}={}){n=convertAgent(n);return _createHttpClient(deferred((()=>e.then((r=>{let s;return s=e===kyOriginalPromise?r.create({headers:{...DEFAULT_HEADERS,...t},...n}):r.extend({headers:t,...n}),s})))))}function _createHttpClient(e){async function t(...n){const r=await e,s=(n[1]&&n[1].method||"get").toLowerCase();return PROXY_METHODS.has(s)?t[s].apply(r[s],n):(n[1]=convertAgent(n[1]),r.apply(r,n))}for(const n of PROXY_METHODS)t[n]=async function(...t){const r=await e;return _handleResponse(r[n],r,t)};return t.create=function({headers:e={},...t}){return createInstance({headers:e,...t})},t.extend=function({headers:t={},...n}){return createInstance({parent:e,headers:t,...n})},Object.defineProperty(t,"stop",{get:async()=>(await e).stop}),t}async function _handleResponse(e,t,n){let r;n[1]=convertAgent(n[1]);const[s]=n;try{r=await e.apply(t,n)}catch(c){return _handleError({error:c,url:s})}const{parseBody:o=!0}=n[1]||{};let a;if(o){const e=r.headers.get("content-type");e&&e.includes("json")&&(a=await r.json())}return Object.defineProperty(r,"data",{value:a}),r}async function _handleError({error:e,url:t}){if(e.requestUrl=t,!e.response)throw"Failed to fetch"===e.message&&(e.message=`Failed to fetch "${t}". Possible CORS error.`),"TimeoutError"===e.name&&(e.message=`Request to "${t}" timed out.`),e;e.status=e.response.status;const n=e.response.headers.get("content-type");if(n&&n.includes("json")){const t=await e.response.json();e.message=t.message||e.message,e.data=t}throw e}const httpClient=createInstance();exports.DEFAULT_HEADERS=DEFAULT_HEADERS,exports.httpClient=httpClient,exports.kyPromise=kyOriginalPromise;